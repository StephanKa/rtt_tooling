# --- interface & transport ---
source [find interface/stlink.cfg]
transport select swd

# --- target ---
source [find target/stm32l4x.cfg]

# --- bring OpenOCD up ---
reset_config srst_only

# --- RTT: Option A â€” scan a RAM window for the control block ---
# STM32L476 has SRAM1 at 0x2000_0000 (96 KB typical) and SRAM2 at 0x1000_0000.
# Start scan at SRAM1 base and cover enough bytes to include your RTT CB.
rtt setup 0x20000000 0x18000 "SEGGER RTT"

# Expose RTT channel 0 via TCP port 19021 (you can pick another port)
rtt server start 19021 0

# --- (optional) also expose channel 1 for input to the target ---
rtt server start 19022 1

# Attach 'rtt start' to the reset-init event
$_TARGETNAME configure -event reset-init {
    rtt start
}
